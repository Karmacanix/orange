{% extends "base.html" %}
{% load i18n %}
{% load staticfiles %}
{# Load the tag library #}
{% load worka_tags %}
{% load bootstrap3 %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript %}

{% block title %}{% trans "Project Details" %}{% endblock %}

{% block content %}
<script type="text/javascript">
    $(function() {
        $('#myTaskTable tbody tr').formset({
            prefix: '{{ task_formset.prefix }}',
            formCssClass: 'dynamic-taskformset'
        });
    })
</script>
<script type="text/javascript">
    $(function() {
        $('#myTeamTable tbody tr').formset({
            prefix: '{{ team_formset.prefix }}',
            formCssClass: 'dynamic-teamformset'
        });
    })
</script>
<br>
<br>
{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

<ul class="nav nav-tabs">
	<li class="active"><a data-toggle="tab" href="#home">Details</a></li>
	<li><a data-toggle="tab" href="#task">Tasks</a></li>
	<li><a data-toggle="tab" href="#team">Team members</a></li>
</ul>

<div class="tab-content">
	<div id="home" class="tab-pane fade in active">
		<h3>Project Details</h3>
		<form class="form-horizontal" method="post" action="{% url 'project:projectUpdate' project.id %}">
			{% csrf_token %}
			{% bootstrap_form form %}
		</form>
	</div>
</div>

<div id="task" class="tab-pane fade">
	<h3>Tasks</h3>
	<form class="form-horizontal" id="myProjectTasks" action="." method="post">
		{% csrf_token %} 
		{{ task_formset.management_form }}
		<table id="myTaskTable" class="table table-striped table-hover">
			<thead>
				<th>Name</th>
				<th>Active</th>
				<th>-</th>
			</thead>
			<tbody>
				{% for form in task_formset %}
				<tr><td>
					{% for fld in form.hidden_fields %}{{ fld }}{% endfor %}
					{% if form.instance.pk %}{{ form.DELETE }}{% endif %}
				{{form.title|addcss:"form-control"}}
			</td>
			<td>{{form.is_active|addcss:"form-control"}}</td>
			<td></td>
			</tr>
				{% endfor %}
			</tbody>
		</table>
		<div class="row text-right">
			<button class="btn btn-link btn-lg"><a href="{% url 'project:projectList' %}">project list <i class="fa fa-level-up fa-1"></i> </a></button>
			<button class="btn btn-warning btn-lg"><i class="fa fa-plus-circle fa-1"></i> new</button>
			<button type="submit" class="btn btn-primary btn-lg"><i class="fa fa-save fa-1"></i> save</button>
		</div>
	</form>
	<hr></hr>
</div>

<div id="team" class="tab-pane fade">
	<h3>Team members</h3>
	<form class="form-horizontal" id="myProjectTeam" action="." method="post">
		{% csrf_token %} 
		{{ team_formset.management_form }}
		<table id="myTeamTable"  class="table table-striped table-hover">
			<thead>
				<th>User</th>
				<th>Allocation %</th>
				<th>Active</th>
				<th>Rate $</th>
				<th>-</th>
			</thead>
			<tbody>
				{% for form in team_formset %}
				<tr>
					<td>{% for fld in form.hidden_fields %}{{ fld }}{% endfor %}
						{% if form.instance.pk %}{{ form.DELETE }}{% endif %}
					{{form.user|addcss:"form-control"}}
				</td>
				<td>
				{{form.percent_allocated|addcss:"form-control"}}
			</td>
			<td>{{form.is_active|addcss:"form-control"}}</td>
			<td>
			{{form.project_rate|addcss:"form-control"}}
		</td>
		<td></td>
	</tr>
{% endfor %}
</tbody>
</table>



<hr></hr>
<div class="row text-right">  
<button class="btn btn-link btn-lg"><a href="{% url 'project:projectList' %}">project list <i class="fa fa-level-up fa-1"></i> </a></button>
<button class="btn btn-warning btn-lg"><i class="fa fa-plus-circle fa-1"></i> new</button>
<button type="submit" class="btn btn-primary btn-lg"><i class="fa fa-save fa-1"></i> save</button>
</div>
</form>

</div>

<script>
$(function () {
$('.datetime-input').datetimepicker({
format:'DD-MM-YYYY'
});
});
</script>
{% endblock %}